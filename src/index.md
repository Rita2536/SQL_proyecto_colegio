-- GENERAR EL DDL

DROP DATABASE IF EXISTS colegio; 

CREATE DATABASE colegio;

USE colegio;

-- Tabla PERSONA
CREATE TABLE PERSONA (
    ID_PERSONA INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR(100),
    APELLIDO VARCHAR (50),
    DNI INT,
    TIPO VARCHAR(20),
    FECHA_NACIMIENTO DATETIME,
    MAIL VARCHAR(50),
    ESTADO_CIVIL VARCHAR(20),
    FECHA_ALTA DATETIME,
    USUARIO_ALTA VARCHAR(20),
    FECHA_MODIF DATETIME
);

-- Tabla DOMICILIO
CREATE TABLE DOMICILIO (
    ID_domicilio INT PRIMARY KEY AUTO_INCREMENT,
    ID_PERSONA INT,
    ID_LOCALIDAD INT,
    CALLE VARCHAR(100),
    NUMERO INT,
    PISO INT,
    DEPARTAMENTO VARCHAR(10),
    BARRIO VARCHAR(50)
  );

-- Tabla LOCALIDAD
CREATE TABLE LOCALIDAD (
    ID_LOCALIDAD INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR(100),
    CODIGO_POSTAL VARCHAR(20)
);

-- Tabla CONCEPTO_ALUMNO
CREATE TABLE CONCEPTO_ALUMNO (
    ID_CONCEPTO INT PRIMARY KEY AUTO_INCREMENT,
    ID_ALUMNO INT,
    NOTA VARCHAR(20)
);

-- Tabla CALIFICACIONES
CREATE TABLE CALIFICACIONES (
    ID_CALIFICACIONES INT PRIMARY KEY AUTO_INCREMENT,
    ID_ALUMNO INT,
    ANO DATE,
    CICLO VARCHAR(20),
    CURSO VARCHAR(10),
    DIVISION VARCHAR(10),
    ID_MATERIA INT,
    NOTA VARCHAR(10),
    ESCALA VARCHAR(10),
    TIPO VARCHAR(15)
);

-- Tabla CONCETPO
CREATE TABLE CONCEPTO (
    ID_CONCEPTO INT PRIMARY KEY AUTO_INCREMENT,
    DESCRIPCION VARCHAR(100),
    NOMBRE VARCHAR(25)
);

-- Tabla CURSO_MATERIA
CREATE TABLE CURSO_MATERIA (
    ID_CURSO_MATERIA INT PRIMARY KEY AUTO_INCREMENT,
    ID_MATERIA INT,
    ANO DATE,
    CICLO VARCHAR(20),
    CURSO VARCHAR(10),
    DIVISION VARCHAR(10)
);

-- Tabla USUARIOS_SISTEMA
CREATE TABLE USUARIOS_SISTEMA (
    ID_USUARIOS_SISTEMA INT PRIMARY KEY AUTO_INCREMENT,
    ID_PERSONA INT,
    USUARIO VARCHAR(50),
    CONTRASENA VARCHAR(20)
);

-- Tabla ALUMNO
CREATE TABLE ALUMNO (
    ID_ALUMNO INT PRIMARY KEY AUTO_INCREMENT,
    ID_PERSONA INT,
    ANO_CURSA DATE,
    CICLO VARCHAR(20),
    CURSO VARCHAR(10),
    DIVISION VARCHAR(10),
    DNI INT
);

-- Tabla TELEFONOS
CREATE TABLE TELEFONOS (
    ID_TELEFONOS INT PRIMARY KEY AUTO_INCREMENT,
    ID_MATERIA INT,
    CODIGO INT,
    NUMERO INT
);
    
-- Tabla MATERIA
CREATE TABLE MATERIA (
    ID_MATERIA INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR (50),
    CURSO VARCHAR(10),
    DIVISION VARCHAR(10),
    CICLO VARCHAR(10)
);  

-- Tabla ESCALA
CREATE TABLE ESCALA (
    ID_ESCALA INT PRIMARY KEY AUTO_INCREMENT,
    TIPO VARCHAR (50),
    VALOR VARCHAR(10)
); 

 -- FOREIGN KEYS DEFINITION

-- CALIFICACIONES

ALTER TABLE CALIFICACIONES
    ADD CONSTRAINT FK_ID_ALUMNO
    FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS(ID_ALUMNO);
    
-- CONCEPTO_ALUMNO
ALTER TABLE CONCEPTO_ALUMNO
    ADD CONSTRAINT FK_ID_ALUMNO
    FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS(ID_ALUMNO);
    
-- CURSO_MATERIA
ALTER TABLE CURSO_MATERIA
    ADD CONSTRAINT FK_CURSO_MATERIA
    FOREIGN KEY (ID_MATERIA) REFERENCES MATERIA(ID_MATERIA);
    

